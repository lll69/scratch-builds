(window.webpackJsonpGUI=window.webpackJsonpGUI||[]).push([["addon-entry-gamepad"],{"./node_modules/css-loader/index.js!./src/addons/addons/gamepad/gamepadlib.css":
/*!****************************************************************************!*\
  !*** ./node_modules/css-loader!./src/addons/addons/gamepad/gamepadlib.css ***!
  \****************************************************************************/
/*! no static exports found */function(e,t,n){var s=n(/*! ../../../../node_modules/css-loader/lib/url/escape.js */"./node_modules/css-loader/lib/url/escape.js");(e.exports=n(/*! ../../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,'.gamepadlib-selector {\n  width: 100%;\n  margin-bottom: 3px;\n}\n\n.gamepadlib-content {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n.gamepadlib-content-buttons {\n  padding-right: 10px;\n}\n\n.gamepadlib-mapping {\n  display: flex;\n  align-items: center;\n  margin-bottom: 3px;\n}\n.gamepadlib-mapping-label {\n  width: 100px;\n  text-align: center;\n}\n.gamepadlib-keyinput {\n  text-align: center;\n  width: 75px;\n  height: 25px;\n  border-radius: 0;\n  border: 1px solid black;\n  background: white;\n  color: black;\n  box-sizing: border-box;\n  padding: 0;\n  margin: 0;\n}\n[theme="dark"] .gamepadlib-keyinput {\n  background-color: var(--ui-tertiary);\n  border-color: var(--ui-black-transparent);\n  color: var(--text-primary);\n}\n.gamepadlib-mapping[data-value="1"] .gamepadlib-keyinput {\n  background: yellow;\n}\n[theme="dark"] .gamepadlib-mapping[data-value="1"] .gamepadlib-keyinput {\n  background: hsl(60, 100%, 20%)\n}\n.gamepadlib-keyinput[data-accepting-input="true"] {\n  background: #d6fff9;\n}\n[theme="dark"] .gamepadlib-keyinput[data-accepting-input="true"] {\n  background: hsl(171, 100%, 20%);\n}\n.gamepadlib-keyinput[data-empty="true"]:not([data-accepting-input="true"]) {\n  color: #aaa;\n  font-style: italic;\n}\n\n.gamepadlib-axis {\n  margin-bottom: 8px;\n  text-align: center;\n}\n.gamepadlib-axis-circle {\n  position: relative;\n  width: 150px;\n  height: 150px;\n  border: 1px solid black;\n  overflow: hidden;\n}\n[theme="dark"] .gamepadlib-axis-circle {\n  border-color: var(--ui-black-transparent);\n}\n.gamepadlib-axis-dot {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  background-image: url('+s(n(/*! ./dot.svg */"./src/addons/addons/gamepad/dot.svg"))+");\n  width: 8px;\n  height: 8px;\n  transform: translate(-50%, -50%);\n  pointer-events: none;\n}\n.gamepadlib-axis-mapping {\n  width: 100%;\n}\n\n.gamepadlib-axis-circle-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper {\n  position: absolute;\n}\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(1) {\n  left: 50%;\n  top: 0;\n  transform: translateX(-50%);\n}\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(2) {\n  left: 0;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(3) {\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.gamepadlib-axis-circle-overlay > .gamepadlib-axis-mapper:nth-of-type(4) {\n  left: 50%;\n  bottom: 0;\n  transform: translateX(-50%);\n}\n",""])},"./node_modules/css-loader/index.js!./src/addons/addons/gamepad/style.css":
/*!***********************************************************************!*\
  !*** ./node_modules/css-loader!./src/addons/addons/gamepad/style.css ***!
  \***********************************************************************/
/*! no static exports found */function(e,t,n){(e.exports=n(/*! ../../../../node_modules/css-loader/lib/css-base.js */"./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,'[dir="ltr"] .sa-gamepad-container {\n  margin-right: 0.2rem;\n}\n[dir="rtl"] .sa-gamepad-container {\n  margin-left: 0.2rem;\n}\n\n.sa-gamepad-popup-outer {\n  /* above fullscreen */\n  z-index: 99999;\n}\n.sa-gamepad-popup {\n  box-sizing: border-box;\n  width: 700px;\n  max-height: min(800px, 85vh);\n  height: 100%;\n  max-width: 85%;\n  margin: 50px auto;\n  display: flex;\n  flex-direction: column;\n}\n.sa-gamepad-popup-content {\n  padding: 1.5rem 2.25rem;\n  height: 100%;\n  overflow-y: auto;\n}\n\n.sa-gamepad-popup [class*="modal_header-item-title"] {\n  margin: 0 -20rem 0 0;\n}\n\n.sa-gamepad-cursor {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 9999;\n  user-select: none;\n  pointer-events: none;\n  will-change: transform;\n  image-rendering: optimizeSpeed;\n  image-rendering: crisp-edges;\n  image-rendering: pixelated;\n}\n.sa-gamepad-cursor-down {\n  filter: invert(100%);\n}\n\n.sa-gamepad-small .sa-gamepad-container[data-editor-mode="editor"] {\n  display: none !important;\n}\n\n.sa-gamepad-hide-cursor [class^="stage_stage_"] {\n  cursor: none;\n}\n\n.sa-gamepad-browser-support-warning {\n  font-weight: bold;\n  margin-bottom: 10px;\n}\n\n.sa-gamepad-extra-options {\n  display: none;\n}\n.sa-gamepad-has-controller .sa-gamepad-extra-options {\n  display: block;\n}\n\n.sa-gamepad-store-settings {\n  display: block;\n}\n.sa-gamepad-store-settings > input {\n  margin-right: 4px;\n}\n\n.sa-gamepad-reset-button {\n  margin: 8px 8px 8px 0;\n}\n',""])},"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/active.png":
/*!************************************************************************************!*\
  !*** ./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/active.png ***!
  \************************************************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGAQMAAADaAn0LAAAABlBMVEX///8AAABVwtN+AAAADklEQVQI12MAAQMgBAIAAkwAYUis6mUAAAAASUVORK5CYII="},"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/close.svg":
/*!***********************************************************************************!*\
  !*** ./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/close.svg ***!
  \***********************************************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCI+PHBhdGggZD0iTTMuNzQgNi40OFYxTTEgMy43NGg1LjQ4IiBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4Ii8+PC9zdmc+"},"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/cursor.png":
/*!************************************************************************************!*\
  !*** ./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/cursor.png ***!
  \************************************************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGAQMAAADaAn0LAAAABlBMVEUAAAD///+l2Z/dAAAADklEQVQI12MAAQMgBAIAAkwAYUis6mUAAAAASUVORK5CYII="},"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/dot.svg":
/*!*********************************************************************************!*\
  !*** ./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/dot.svg ***!
  \*********************************************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCAyLjExNyAyLjExNyI+PGNpcmNsZSBjeD0iMS4wNTgiIGN5PSIxLjA1OCIgcj0iMS4wNTgiIGZpbGw9InJlZCIvPjwvc3ZnPg=="},"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/gamepad.svg":
/*!*************************************************************************************!*\
  !*** ./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/gamepad.svg ***!
  \*************************************************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtaGlkZGVuPSJ0cnVlIiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgc3R5bGU9Ii1tcy10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDM2MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiI+PHBhdGggZmlsbD0iIzU3NWU3NSIgZD0iTTM2OCAxNjhoLTk2di02NGgxNzZhMjQuMDI3IDI0LjAyNyAwIDAgMCAyNC0yNFYxNmgtMzJ2NTZIMjY0YTI0LjAyNyAyNC4wMjcgMCAwIDAtMjQgMjR2NzJoLTk2QTEyOC4xNDUgMTI4LjE0NSAwIDAgMCAxNiAyOTZ2MTAwLjk1M0E5MS4xNSA5MS4xNSAwIDAgMCAxMDcuMDQ3IDQ4OGgxLjhhOTAuODA3IDkwLjgwNyAwIDAgMCA2OS45NTMtMzIuNzZMMjMxLjUgMzkyaDQ4LjYyOGw1Mi42NjYgNjguNDY1QTkxLjA0NiA5MS4wNDYgMCAwIDAgNDk2IDQwNC45NTNWMjk2YTEyOC4xNDUgMTI4LjE0NSAwIDAgMC0xMjgtMTI4em05NiAyMzYuOTUzYTU5LjA0NyA1OS4wNDcgMCAwIDEtMTA1Ljg0OSAzNkwyOTUuODc4IDM2MGgtNzkuMzcybC02Mi4yOTQgNzQuNzU0QTU4Ljg5MyA1OC44OTMgMCAwIDEgMTA4Ljg1IDQ1NmgtMS44QTU5LjExMyA1OS4xMTMgMCAwIDEgNDggMzk2Ljk1M1YyOTZhOTYuMTA4IDk2LjEwOCAwIDAgMSA5Ni05NmgyMjRhOTYuMTA4IDk2LjEwOCAwIDAgMSA5NiA5NnoiLz48cGF0aCBmaWxsPSIjNTc1ZTc1IiBkPSJNMzYwIDI0OGgzMnYzMmgtMzJ6bTAgODBoMzJ2MzJoLTMyem0tNDAtNDBoMzJ2MzJoLTMyem04MCAwaDMydjMyaC0zMnptLTI0OC00MGgtMzJ2NDBIODB2MzJoNDB2NDBoMzJ2LTQwaDQwdi0zMmgtNDB2LTQweiIvPjwvc3ZnPg=="},"./src/addons/addons/gamepad/_runtime_entry.js":
/*!*****************************************************!*\
  !*** ./src/addons/addons/gamepad/_runtime_entry.js ***!
  \*****************************************************/
/*! exports provided: resources */function(e,t,n){"use strict";n.r(t),n.d(t,"resources",(function(){return r}));var s=n(/*! ./userscript.js */"./src/addons/addons/gamepad/userscript.js"),a=n(/*! css-loader!./style.css */"./node_modules/css-loader/index.js!./src/addons/addons/gamepad/style.css"),i=n.n(a),o=n(/*! css-loader!./gamepadlib.css */"./node_modules/css-loader/index.js!./src/addons/addons/gamepad/gamepadlib.css"),d=n.n(o);const r={"userscript.js":s.default,"style.css":i.a,"gamepadlib.css":d.a}},"./src/addons/addons/gamepad/dot.svg":
/*!*******************************************!*\
  !*** ./src/addons/addons/gamepad/dot.svg ***!
  \*******************************************/
/*! no static exports found */function(e,t,n){e.exports=n.p+"static/assets/88a77444f0bb453209bf1c62becbd37c.svg"},"./src/addons/addons/gamepad/gamepadlib.js":
/*!*************************************************!*\
  !*** ./src/addons/addons/gamepad/gamepadlib.js ***!
  \*************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! ../../event-target.js */"./src/addons/event-target.js");let a=window.console;const i=[{type:"key",high:"ArrowRight",low:"ArrowLeft",deadZone:.5},{type:"key",high:"ArrowDown",low:"ArrowUp",deadZone:.5}],o=[{type:"key",high:"d",low:"a",deadZone:.5},{type:"key",high:"s",low:"w",deadZone:.5}],d=[{type:"virtual_cursor",high:"+x",low:"-x",sensitivity:.6,deadZone:.2},{type:"virtual_cursor",high:"-y",low:"+y",sensitivity:.6,deadZone:.2}],r=e=>{if("object"!=typeof e||!e)return a.warn("invalid mapping",e),{type:"key",high:null,low:null};const t=Object.assign({},e);if("key"===t.type)void 0===t.deadZone&&(t.deadZone=.5),void 0===t.high&&(t.high=""),void 0===t.low&&(t.low="");else if("mousedown"===t.type)void 0===t.deadZone&&(t.deadZone=.5),void 0===t.button&&(t.button=0);else{if("virtual_cursor"!==t.type)return a.warn("unknown mapping type",t.type),{type:"key",high:null,low:null};void 0===t.high&&(t.high=""),void 0===t.low&&(t.low=""),void 0===t.sensitivity&&(t.sensitivity=10),void 0===t.deadZone&&(t.deadZone=.5)}return t},l=e=>Object.assign({},e),c=l,p=e=>{const t=l(e);return delete t.deadZone,delete t.low,t},u=(e,t)=>{for(;e.length<t;)e.push({type:"key",high:null,low:null});return e.length=t,e},m=e=>u([],e),h=e=>({usesArrows:e.has("ArrowUp")||e.has("ArrowDown")||e.has("ArrowRight")||e.has("ArrowLeft"),usesWASD:e.has("w")&&e.has("s")||e.has("a")&&e.has("d")}),g=e=>"".concat(e.id," (").concat(e.index,")");class y{constructor(e,t){this.gamepad=e,this.gamepadLib=t,this.resetMappings()}resetMappings(){this.buttonMappings=this.getDefaultButtonMappings().map(r),this.axesMappings=this.getDefaultAxisMappings().map(r)}clearMappings(){this.buttonMappings=m(this.gamepad.buttons.length),this.axesMappings=m(this.gamepad.axes.length)}getDefaultButtonMappings(){let e;if(this.gamepadLib.hints.importedSettings)e=this.gamepadLib.hints.importedSettings.buttons;else{const t=this.gamepadLib.hints.usedKeys,n=new Set,{usesArrows:s,usesWASD:a}=h(t);a&&(n.add("w"),n.add("a"),n.add("s"),n.add("d"));const i=["p","q","r"],o=[" ","Enter","e","f","z","x","c",...Array.from(t).filter(e=>1===e.length&&!i.includes(e))],d=e=>{for(const s of e)if(t.has(s)&&!n.has(s))return n.add(s),s;return null},r=()=>d(o),l=()=>d(i),c=()=>s||!a?"ArrowUp":"w",p=()=>s||!a?"ArrowDown":"s",u=()=>s||!a?"ArrowRight":"d",m=()=>s||!a?"ArrowLeft":"a",g=(()=>s&&t.has("ArrowUp")?"ArrowUp":a&&t.has("w")?"w":d(o))();let y=r(),b=r(),v=r();!g||y||b||v||(y=g,b=g,v=g),g&&y&&!b&&!v&&(b=g,v=y),e=[],e[0]={type:"key",high:g},e[1]={type:"key",high:y},e[2]={type:"key",high:b},e[3]={type:"key",high:v},e[4]={type:"mousedown"},e[5]={type:"mousedown"},e[6]={type:"mousedown"},e[7]={type:"mousedown"},e[9]={type:"key",high:l()},e[8]={type:"key",high:l()},e[10]={type:"key",high:null,low:null},e[11]={type:"key",high:null,low:null},e[12]={type:"key",high:c()},e[13]={type:"key",high:p()},e[14]={type:"key",high:m()},e[15]={type:"key",high:u()}}return u(e,this.gamepad.buttons.length)}getDefaultAxisMappings(){let e=[];if(this.gamepadLib.hints.importedSettings)e=this.gamepadLib.hints.importedSettings.axes;else if(4===this.gamepad.axes.length){const t=this.gamepadLib.hints.usedKeys,{usesArrows:n,usesWASD:s}=h(t);s?(e.push(o[0]),e.push(o[1])):n?(e.push(i[0]),e.push(i[1])):(e.push(d[0]),e.push(d[1])),e.push(d[0]),e.push(d[1])}return u(e,this.gamepad.axes.length)}}const b=()=>({usedKeys:new Set,importedSettings:null,generated:!1});class v extends s.default{constructor(){super(),this.gamepads=new Map,this.handleConnect=this.handleConnect.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this),this.update=this.update.bind(this),this.animationFrame=null,this.currentTime=null,this.deltaTime=0,this.virtualCursor={x:0,y:0,maxX:1/0,minX:-1/0,maxY:1/0,minY:-1/0,modified:!1},this._editor=null,this.connectCallbacks=[],this.hints=b(),this.keysPressedThisFrame=new Set,this.oldKeysPressed=new Set,this.mouseButtonsPressedThisFrame=new Set,this.oldMouseDown=new Set,this.addEventHandlers()}addEventHandlers(){window.addEventListener("gamepadconnected",this.handleConnect),window.addEventListener("gamepaddisconnected",this.handleDisconnect)}removeEventHandlers(){window.removeEventListener("gamepadconnected",this.handleConnect),window.removeEventListener("gamepaddisconnected",this.handleDisconnect)}gamepadConnected(){return this.gamepads.size>0?Promise.resolve():new Promise(e=>{this.connectCallbacks.push(e)})}ensureHintsGenerated(){this.hints.generated||(this.getHintsLazily&&Object.assign(this.hints,this.getHintsLazily()),this.hints.generated=!0)}resetControls(){this.hints=b(),this.ensureHintsGenerated();for(const e of this.gamepads.values())e.resetMappings()}clearControls(){for(const e of this.gamepads.values())e.clearMappings()}handleConnect(e){this.ensureHintsGenerated();for(const e of this.connectCallbacks)e();this.connectCallbacks=[];const t=e.gamepad,n=g(t);a.log("connected",t);const s=new y(t,this);this.gamepads.set(n,s),null===this.animationFrame&&(this.animationFrame=requestAnimationFrame(this.update)),this.dispatchEvent(new CustomEvent("gamepadconnected",{detail:s}))}handleDisconnect(e){const t=e.gamepad,n=g(t);a.log("disconnected",t);const s=this.gamepads.get(n);this.gamepads.delete(n),this.dispatchEvent(new CustomEvent("gamepaddisconnected",{detail:s})),0===this.gamepads.size&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null,this.currentTime=null)}dispatchKey(e,t){t?this.dispatchEvent(new CustomEvent("keydown",{detail:e})):this.dispatchEvent(new CustomEvent("keyup",{detail:e}))}dispatchMouse(e,t){t?this.dispatchEvent(new CustomEvent("mousedown",{detail:e})):this.dispatchEvent(new CustomEvent("mouseup",{detail:e}))}dispatchMouseMove(e,t){this.dispatchEvent(new CustomEvent("mousemove",{detail:{x:e,y:t}}))}updateButton(e,t){if("key"===t.type)e>=t.deadZone?t.high&&this.keysPressedThisFrame.add(t.high):e<=-t.deadZone&&t.low&&this.keysPressedThisFrame.add(t.low);else if("mousedown"===t.type){Math.abs(e)>=t.deadZone&&this.mouseButtonsPressedThisFrame.add(t.button)}else if("virtual_cursor"===t.type){const n=t.deadZone;let s;if(e>=n&&(s=t.high),e<=-n&&(s=t.low),s){const a=(Math.abs(e)-n)/(1-n),i=a*a*t.sensitivity*this.deltaTime;"+x"===s?this.virtualCursor.x+=i:"-x"===s?this.virtualCursor.x-=i:"+y"===s?this.virtualCursor.y+=i:"-y"===s&&(this.virtualCursor.y-=i),this.virtualCursor.modified=!0}}}update(e){this.oldKeysPressed=this.keysPressedThisFrame,this.oldMouseButtonsPressed=this.mouseButtonsPressedThisFrame,this.keysPressedThisFrame=new Set,this.mouseButtonsPressedThisFrame=new Set,null===this.currentTime?this.deltaTime=0:this.deltaTime=e-this.currentTime,this.deltaTime=Math.max(Math.min(this.deltaTime,1e3),0),this.currentTime=e,this.animationFrame=requestAnimationFrame(this.update);const t=navigator.getGamepads();for(const e of t){if(null===e)continue;const t=g(e),n=this.gamepads.get(t);for(let t=0;t<e.buttons.length;t++){const s=e.buttons[t].value,a=n.buttonMappings[t];this.updateButton(s,a)}for(let t=0;t<e.axes.length;t++){const s=e.axes[t],a=n.axesMappings[t];this.updateButton(s,a)}}this._editor&&this._editor.update(t);for(const e of this.keysPressedThisFrame)this.oldKeysPressed.has(e)||this.dispatchKey(e,!0);for(const e of this.oldKeysPressed)this.keysPressedThisFrame.has(e)||this.dispatchKey(e,!1);for(const e of this.mouseButtonsPressedThisFrame)this.oldMouseButtonsPressed.has(e)||this.dispatchMouse(e,!0);for(const e of this.oldMouseButtonsPressed)this.mouseButtonsPressedThisFrame.has(e)||this.dispatchMouse(e,!1);this.virtualCursor.modified&&(this.virtualCursor.modified=!1,this.virtualCursor.x>this.virtualCursor.maxX&&(this.virtualCursor.x=this.virtualCursor.maxX),this.virtualCursor.x<this.virtualCursor.minX&&(this.virtualCursor.x=this.virtualCursor.minX),this.virtualCursor.y>this.virtualCursor.maxY&&(this.virtualCursor.y=this.virtualCursor.maxY),this.virtualCursor.y<this.virtualCursor.minY&&(this.virtualCursor.y=this.virtualCursor.minY),this.dispatchMouseMove(this.virtualCursor.x,this.virtualCursor.y))}editor(){return this._editor||(this._editor=new A(this)),this._editor}}v.browserHasBrokenGamepadAPI=()=>!navigator.getGamepads||(!(!navigator.userAgent.includes("Firefox")||!navigator.userAgent.includes("Linux"))||!(!navigator.userAgent.includes("Firefox")||!navigator.userAgent.includes("Mac OS"))),v.setConsole=e=>a=e;const w=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},f=e=>"gamepadlib-axis-".concat(e);class A extends s.default{constructor(e){super(),this.gamepadLib=e,this.root=Object.assign(document.createElement("div"),{className:"gamepadlib-root"}),this.selector=Object.assign(document.createElement("select"),{className:"gamepadlib-selector"}),this.content=Object.assign(document.createElement("div"),{className:"gamepadlib-content"}),this.root.appendChild(this.selector),this.root.appendChild(this.content),this.onSelectorChange=this.onSelectorChange.bind(this),this.onGamepadsChange=this.onGamepadsChange.bind(this),this.selector.addEventListener("change",this.onSelectorChange),this.gamepadLib.addEventListener("gamepadconnected",this.onGamepadsChange),this.gamepadLib.addEventListener("gamepaddisconnected",this.onGamepadsChange),this.buttonIdToElement=new Map,this.axisIdToElement=new Map,this.hidden=!1,this.msg=(e,t)=>e}onSelectorChange(){this.updateContent(),this.dispatchEvent(new CustomEvent("gamepad-changed"))}onGamepadsChange(){this.updateAllContent(),this.dispatchEvent(new CustomEvent("gamepad-changed"))}updateAllContent(){this.updateDropdown(),this.updateContent(),this.focus()}updateDropdown(){w(this.selector);const e=Array.from(this.gamepadLib.gamepads.entries());if(0!==e.length){this.selector.hidden=!1;for(const[t,n]of e){const e=document.createElement("option");e.textContent=t,e.value=t,this.selector.appendChild(e)}}else this.selector.hidden=!0}keyToString(e){return" "===e?this.msg("key-space"):"ArrowUp"===e?this.msg("key-up"):"ArrowDown"===e?this.msg("key-down"):"ArrowLeft"===e?this.msg("key-left"):"ArrowRight"===e?this.msg("key-right"):"Enter"===e?this.msg("key-enter"):1===e.length?e.toUpperCase():e.replace(/[a-z]([A-Z])/,e=>"".concat(e[0]," ").concat(e[1]))}createButtonMapping(e,t,{property:n="high",allowClick:s=!0}={}){const a=document.createElement("input");a.readOnly=!0,a.className="gamepadlib-keyinput",a.title=this.msg("keyinput-title"),a.dataset.index=t;const i=()=>{const s=e[t];if(a.dataset.empty=!1,"key"===s.type)null===s[n]?(a.value=this.msg("key-none"),a.dataset.empty=!0):a.value=this.keyToString(s[n]);else if("mousedown"===s.type){let e=this.msg("key-click");0!==s.button&&(e+=" (".concat(s.button,")")),a.value=e}else a.value="??? ".concat(s.type)},o=()=>{e[t]=r(e[t]),d=!1,a.blur(),i(),a.dispatchEvent(new CustomEvent("mapping-changed")),this.changed()};let d=!1;const l=s=>{if(d){s.preventDefault();const a=s.key;if(["Alt"].includes(a))return;const i=e[t],d=["ArrowUp","ArrowDown","ArrowRight","ArrowLeft","Enter","Shift","CapsLock","ScrollLock","Control","Insert","Home","End","PageUp","PageDown"];1===a.length||d.includes(a)?(i.type="key",i[n]=a):"Escape"!==a&&(i.type="key",i[n]=null),o()}else"Enter"===s.key&&(s.preventDefault(),s.target.click())},c=["Shift","Control"],p=()=>{a.dataset.acceptingInput=!1,d&&(d=!1,i())};return a.addEventListener("contextmenu",e=>{e.preventDefault()}),a.addEventListener("mouseup",n=>{if(n.preventDefault(),d)if(s){const s=e[t];s.type="mousedown",s.button=n.button,o()}else p();else a.value="...",a.dataset.acceptingInput=!0,d=!0}),a.addEventListener("keydown",e=>{c.includes(e.key)||l(e)}),a.addEventListener("keyup",e=>{c.includes(e.key)&&l(e)}),a.addEventListener("blur",p),i(),a}createAxisMapping(e,t){const n=document.createElement("select");n.className="gamepadlib-axis-mapping",n.id=f(t),n.appendChild(Object.assign(document.createElement("option"),{textContent:this.msg("axis-none"),value:"none"})),n.appendChild(Object.assign(document.createElement("option"),{textContent:this.msg("axis-cursor"),value:"cursor"})),n.appendChild(Object.assign(document.createElement("option"),{textContent:"WASD",value:"wasd"})),n.appendChild(Object.assign(document.createElement("option"),{textContent:this.msg("axis-arrows"),value:"arrows"})),n.appendChild(Object.assign(document.createElement("option"),{textContent:this.msg("axis-custom"),value:"custom"}));const s=()=>{"key"===e[t].type||"mousedown"===e[t].type?null===e[t].high&&null===e[t].low&&null===e[t+1].high&&null===e[t+1].low?n.value="none":e[t].high===o[0].high&&e[t].low===o[0].low&&e[t+1].high===o[1].high&&e[t+1].low===o[1].low?n.value="wasd":e[t].high===i[0].high&&e[t].low===i[0].low&&e[t+1].high===i[1].high&&e[t+1].low===i[1].low?n.value="arrows":n.value="custom":"virtual_cursor"===e[t].type?n.value="cursor":n.value="none"};s();const a=document.createElement("div");a.className="gamepadlib-axis-circle-overlay";const l=()=>{if(w(a),"key"===e[t].type){const n=[this.createButtonMapping(e,t+1,{property:"low",allowClick:!1}),this.createButtonMapping(e,t,{property:"low",allowClick:!1}),this.createButtonMapping(e,t,{property:"high",allowClick:!1}),this.createButtonMapping(e,t+1,{property:"high",allowClick:!1})];for(const e of n)e.classList.add("gamepadlib-axis-mapper"),e.addEventListener("mapping-changed",s),a.appendChild(e)}};return l(),n.addEventListener("change",()=>{"custom"===n.value?"key"!==e[t].type&&(e[t]=r(i[0]),e[t+1]=r(i[1])):"arrows"===n.value?(e[t]=r(i[0]),e[t+1]=r(i[1])):"wasd"===n.value?(e[t]=r(o[0]),e[t+1]=r(o[1])):"cursor"===n.value?(e[t]=r(d[0]),e[t+1]=r(d[1])):(e[t]=r({type:"key",high:null,low:null}),e[t+1]=r({type:"key",high:null,low:null})),l(),this.changed()}),{circleOverlay:a,selector:n}}hasControllerSelected(){return!!this.selector.value}updateContent(){if(w(this.content),this.hidden)return;const e=this.selector.value;if(!e){const e=document.createElement("div");return e.textContent=this.msg("no-controllers"),void this.content.appendChild(e)}const t=this.gamepadLib.gamepads.get(e);if(!t){const t=document.createElement("div");return t.textContent="Cannot find controller: ".concat(e),void this.content.appendChild(t)}this.buttonIdToElement.clear(),this.axisIdToElement.clear();const n=document.createElement("div");n.className="gamepadlib-content-buttons";const s=t.buttonMappings;for(let e=0;e<s.length;e++){const t=document.createElement("div");t.className="gamepadlib-mapping",t.dataset.id=e;const a=document.createElement("label");a.className="gamepadlib-mapping-label",a.textContent=this.msg("button-n",{n:e});const i="gamepadlib-button-".concat(e);a.htmlFor=i;const o=document.createElement("div");o.className="gamepadlib-mapping-options";const d=this.createButtonMapping(s,e);d.id=i,o.appendChild(d),t.appendChild(a),t.appendChild(o),n.appendChild(t),this.buttonIdToElement.set(e,t)}const a=document.createElement("div");a.className="gamepadlib-content-axes";const i=t.axesMappings;for(let e=0;e<i.length;e+=2){const t=document.createElement("div");t.className="gamepadlib-axis";const n=document.createElement("label");n.textContent=this.msg("axes-a-b",{a:e,b:e+1}),n.htmlFor=f(e);const s=document.createElement("div");s.className="gamepadlib-axis-circle";const{circleOverlay:o,selector:d}=this.createAxisMapping(i,e);s.appendChild(o);const r=document.createElement("div");r.className="gamepadlib-axis-dot",s.appendChild(r),t.appendChild(n),t.appendChild(s),t.appendChild(d),a.appendChild(t),this.axisIdToElement.set(e,r)}this.content.appendChild(n),this.content.appendChild(a)}update(e){if(this.hidden)return;if(!this.selector.value)return;const t=Array.from(e).find(e=>e&&g(e)===this.selector.value);if(t){for(let e=0;e<t.buttons.length;e++){const n=this.buttonIdToElement.get(e);if(n){const s=t.buttons[e].value.toString();s!==n.dataset.value&&(n.dataset.value=s)}}for(let e=0;e<t.axes.length;e+=2){const n=this.axisIdToElement.get(e);if(n){const s=t.axes[e],a=t.axes[e+1]||0,i=75;n.style.transform="translate(-50%, -50%) translate(".concat(s*i,"px, ").concat(a*i,"px)")}}}}export(){const e=this.selector.value;if(!e)return null;const t=this.gamepadLib.gamepads.get(e);return t?{axes:t.axesMappings.map(c),buttons:t.buttonMappings.map(p)}:null}changed(){this.dispatchEvent(new CustomEvent("mapping-changed"))}hide(){this.hidden=!0,this.updateContent()}focus(){this.selector.value&&this.selector.focus()}generateEditor(){return this.hidden=!1,this.updateAllContent(),this.root}}t.default=v},"./src/addons/addons/gamepad/userscript.js":
/*!*************************************************!*\
  !*** ./src/addons/addons/gamepad/userscript.js ***!
  \*************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! url-loader!./active.png */"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/active.png"),a=n(/*! url-loader!./close.svg */"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/close.svg"),i=n(/*! url-loader!./cursor.png */"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/cursor.png"),o=n(/*! url-loader!./dot.svg */"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/dot.svg"),d=n(/*! url-loader!./gamepad.svg */"./node_modules/url-loader/dist/cjs.js!./src/addons/addons/gamepad/gamepad.svg"),r=n(/*! ./gamepadlib.js */"./src/addons/addons/gamepad/gamepadlib.js");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=e=>{if("/active.png"===e)return s.default;if("/close.svg"===e)return a.default;if("/cursor.png"===e)return i.default;if("/dot.svg"===e)return o.default;if("/gamepad.svg"===e)return d.default;throw new Error("Unknown asset: ".concat(e))};t.default=async function({addon:e,global:t,console:n,msg:s}){const a=e.tab.traps.vm;await new Promise(e=>{if(a.editingTarget)return e();a.runtime.once("PROJECT_LOADED",e)});const i=()=>null!==a.runtime._steppingInterval,o=e=>{switch(e){case"right arrow":return"ArrowRight";case"up arrow":return"ArrowUp";case"left arrow":return"ArrowLeft";case"down arrow":return"ArrowDown";case"enter":return"Enter";case"space":return" "}return e.toLowerCase().charAt(0)},d=()=>{const e=[a.runtime.getTargetForStage(),...a.runtime.targets].filter(e=>e.isOriginal).map(e=>e.blocks),t=new Set;for(const n of e)for(const e of Object.values(n._blocks))if("event_whenkeypressed"===e.opcode||"sensing_keyoptions"===e.opcode){if("sensing_keyoptions"===e.opcode&&!e.parent)continue;const n=e.fields.KEY_OPTION.value;t.add(o(n))}return t},l=()=>{const e=a.runtime.getTargetForStage().comments;for(const t of Object.values(e))if(t.text.includes(" // _gamepad_"))return t;return null};r.default.setConsole(n);const p=new r.default;p.getHintsLazily=()=>{const e=(()=>{const e=l();if(!e)return null;const t=e.text.split("\n").find(e=>e.endsWith(" // _gamepad_"));if(!t)return n.warn("Gamepad comment does not contain valid line"),null;const s=t.substr(0,t.length-" // _gamepad_".length);let a;try{if(a=JSON.parse(s),!a||"object"!=typeof a||!Array.isArray(a.buttons)||!Array.isArray(a.axes))throw new Error("Invalid data")}catch(e){return n.warn("Gamepad comment has invalid JSON",e),null}return a})();return e?{importedSettings:e}:{usedKeys:d()}},a.runtime.on("PROJECT_LOADED",()=>{p.resetControls()}),e.settings.get("hide")&&await new Promise(t=>{const n=()=>{e.settings.removeEventListener("change",s),t()},s=()=>{e.settings.get("hide")||n()};p.gamepadConnected().then(n),e.settings.addEventListener("change",s)});const m=a.runtime.renderer,h=m._xRight-m._xLeft,g=m._yTop-m._yBottom,y=m.canvas,b=document.createElement("div");b.className="sa-gamepad-container",e.tab.displayNoneWhileDisabled(b,{display:"flex"});const v=document.createElement("span");v.className=e.tab.scratchClass("button_outlined-button","stage-header_stage-button");const w=document.createElement("div");w.className=e.tab.scratchClass("button_content");const f=document.createElement("img");let A;f.className=e.tab.scratchClass("stage-header_stage-button-icon"),f.draggable=!1,f.src=u("/gamepad.svg"),w.appendChild(f),v.appendChild(w),b.appendChild(v);let x=!1;const C=()=>{a.runtime.emitProjectChanged(),a.editingTarget===a.runtime.getTargetForStage()&&a.emitWorkspaceUpdate()},E=()=>{const e=A.export();if(!e)return void n.warn("Could not export gamepad settings");const t="".concat(s("config-header"),"\n").concat(JSON.stringify(e)).concat(" // _gamepad_"),i=l();if(i)i.text=t;else{a.runtime.getTargetForStage().createComment(Math.random()+"",null,t,50,50,350,150,!1)}C()},k=()=>{x&&E()},M=e=>{x=!!e.target.checked,x?E():(()=>{const e=l();if(e){delete a.runtime.getTargetForStage().comments[e.id],C()}})()},L=()=>{document.body.classList.toggle("sa-gamepad-has-controller",A.hasControllerSelected()),k()};v.addEventListener("click",()=>{A||(A=p.editor(),A.msg=s,A.addEventListener("mapping-changed",k),A.addEventListener("gamepad-changed",L));const t=A.generateEditor();L();const{backdrop:n,container:a,content:i,closeButton:o,remove:d}=e.tab.createModal(s("settings"),{isOpen:!0,useEditorClasses:!0});if(n.addEventListener("click",d),window.addEventListener("keydown",e=>{"Escape"!==e.key||e.target.closest("[data-accepting-input]")||d()}),e.self.addEventListener("disabled",d),n.classList.add("sa-gamepad-popup-outer"),a.classList.add("sa-gamepad-popup"),o.tabIndex="0",o.setAttribute("role","button"),o.addEventListener("click",d),o.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||d()}),i.classList.add("sa-gamepad-popup-content"),r.default.browserHasBrokenGamepadAPI()){const e=document.createElement("div");e.textContent=s("browser-support"),e.className="sa-gamepad-browser-support-warning",i.appendChild(e)}i.appendChild(t);const l=document.createElement("div");l.className="sa-gamepad-extra-options",i.appendChild(l);const c=()=>{A.updateAllContent(),g.checked=!1,x=!1},u=document.createElement("button");u.className="sa-gamepad-reset-button",u.textContent=s("reset"),u.addEventListener("click",()=>{p.resetControls(),c()}),l.appendChild(u);const m=document.createElement("button");m.className="sa-gamepad-reset-button",m.textContent=s("clear"),m.addEventListener("click",()=>{p.clearControls(),c()}),l.appendChild(m);const h=document.createElement("label");h.className="sa-gamepad-store-settings",h.textContent=s("store-in-project");const g=document.createElement("input");g.type="checkbox",g.checked=x,g.addEventListener("change",M),h.prepend(g),l.appendChild(h),A.focus()}),e.tab.redux.state&&"small"===e.tab.redux.state.scratchGui.stageSize.stageSize&&document.body.classList.add("sa-gamepad-small"),document.addEventListener("click",e=>{e.target.closest("[class*='stage-header_stage-button-first']:not(.sa-hide-stage-button)")?document.body.classList.add("sa-gamepad-small"):(e.target.closest("[class*='stage-header_stage-button-last']")||e.target.closest(".sa-hide-stage-button"))&&document.body.classList.remove("sa-gamepad-small")},{capture:!0});const j=document.createElement("img");let D;j.hidden=!0,j.className="sa-gamepad-cursor",j.src=u("/cursor.png"),e.self.addEventListener("disabled",()=>{j.hidden=!0});const N=e=>{j.hidden=!e,clearTimeout(D),e&&(document.body.classList.add("sa-gamepad-hide-cursor"),D=setTimeout(T,8e3))},T=()=>{N(!1)},I=e=>{N(!0),j.classList.toggle("sa-gamepad-cursor-down",e)};let O;if(document.addEventListener("mousemove",()=>{N(!1),document.body.classList.remove("sa-gamepad-hide-cursor")}),window.ResizeObserver){let e=h,t=g;new ResizeObserver(n=>{for(const s of n)e=s.contentRect.width,t=s.contentRect.height}).observe(y),O=()=>[e,t]}else O=()=>{const e=y.getBoundingClientRect();return[e.width,e.height]};let S=0,_=0;const P=t=>{if(e.self.disabled||!i())return;const[n,s]=O();a.postIOData("mouse",c(c({},t),{},{canvasWidth:n,canvasHeight:s,x:(S+h/2)*(n/h),y:s/g*(g/2-_)}))},z=(t,n)=>{!e.self.disabled&&i()&&a.postIOData("keyboard",{key:t,isDown:n})};for(p.virtualCursor.maxX=m._xRight,p.virtualCursor.minX=m._xLeft,p.virtualCursor.maxY=m._yTop,p.virtualCursor.minY=m._yBottom,p.addEventListener("keydown",e=>z(e.detail,!0)),p.addEventListener("keyup",e=>z(e.detail,!1)),p.addEventListener("mousedown",e=>{I(!0),P({isDown:!0,button:e.detail})}),p.addEventListener("mouseup",e=>{I(!1),P({isDown:!1,button:e.detail})}),p.addEventListener("mousemove",e=>{S=e.detail.x,_=e.detail.y,((e,t)=>{N(!0);const n=h/2+e-3,s=g/2-t-3;j.style.transform="translate(".concat(n,"px, ").concat(s,"px)")})(S,_),P({})});;){const t=await e.tab.waitForElement('[class^="stage-header_embed-buttons_"], [class^="stage-header_stage-size-row"], [class^="stage-header_stage-menu-wrapper"] > [class^="button_outlined-button"]',{markAsSeen:!0,reduxEvents:["scratch-gui/mode/SET_PLAYER","scratch-gui/mode/SET_FULL_SCREEN","fontsLoaded/SET_FONTS_LOADED","scratch-gui/locales/SELECT_LOCALE"]});b.dataset.editorMode=e.tab.editorMode,t.className.includes("stage-size-row")?e.tab.appendToSharedSpace({space:"stageHeader",element:b,order:1}):e.tab.appendToSharedSpace({space:"fullscreenStageHeader",element:b,order:0});document.querySelector("[class^='monitor-list_monitor-list-scaler']").appendChild(j)}}}}]);